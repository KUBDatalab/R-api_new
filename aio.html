<!DOCTYPE html>
<!-- START: inst/pkgdown/templates/layout.html --><!-- Generated by pkgdown: do not edit by hand --><html lang="en" data-bs-theme="auto">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<title>Lesson Title: All in One View</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="assets/themetoggle.js"></script><link rel="stylesheet" type="text/css" href="assets/styles.css">
<script src="assets/scripts.js" type="text/javascript"></script><!-- mathjax --><script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      config: ["MMLorHTML.js"],
      jax: ["input/TeX","input/MathML","output/HTML-CSS","output/NativeMML", "output/PreviewHTML"],
      extensions: ["tex2jax.js","mml2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
      TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
      },
      tex2jax: {
        inlineMath: [['\\(', '\\)']],
        displayMath: [ ['$$','$$'], ['\\[', '\\]'] ],
        processEscapes: true
      }
    });
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><!-- Responsive Favicon for The Carpentries --><link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="manifest" href="site.webmanifest">
<link rel="mask-icon" href="safari-pinned-tab.svg" color="#5bbad5">
<meta name="msapplication-TileColor" content="#da532c">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="white">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="black">
</head>
<body>
    <header id="top" class="navbar navbar-expand-md top-nav incubator"><svg xmlns="http://www.w3.org/2000/svg" class="d-none"><symbol id="check2" viewbox="0 0 16 16"><path d="M13.854 3.646a.5.5 0 0 1 0 .708l-7 7a.5.5 0 0 1-.708 0l-3.5-3.5a.5.5 0 1 1 .708-.708L6.5 10.293l6.646-6.647a.5.5 0 0 1 .708 0z"></path></symbol><symbol id="circle-half" viewbox="0 0 16 16"><path d="M8 15A7 7 0 1 0 8 1v14zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16z"></path></symbol><symbol id="moon-stars-fill" viewbox="0 0 16 16"><path d="M6 .278a.768.768 0 0 1 .08.858 7.208 7.208 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277.527 0 1.04-.055 1.533-.16a.787.787 0 0 1 .81.316.733.733 0 0 1-.031.893A8.349 8.349 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.752.752 0 0 1 6 .278z"></path><path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.734 1.734 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.734 1.734 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.734 1.734 0 0 0 1.097-1.097l.387-1.162zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.156 1.156 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.156 1.156 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732L13.863.1z"></path></symbol><symbol id="sun-fill" viewbox="0 0 16 16"><path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8zM8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0zm0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13zm8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5zM3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8zm10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0zm-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0zm9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707zM4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708z"></path></symbol></svg><a class="visually-hidden-focusable skip-link" href="#main-content">Skip to main content</a>
  <div class="container-fluid top-nav-container">
    <div class="col-md-8">
      <div class="large-logo">
        <img id="incubator-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo.svg"><span class="badge text-bg-danger">
          <abbr title="This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.">
            <a href="https://cdh.carpentries.org/the-lesson-life-cycle.html#early-development-pre-alpha-through-alpha" class="external-link alert-link">
              <i aria-hidden="true" class="icon" data-feather="alert-octagon" style="border-radius: 5px"></i>
              Pre-Alpha
            </a>
            <span class="visually-hidden">This lesson is in the pre-alpha phase, which means that it is in early development, but has not yet been taught.</span>
          </abbr>
        </span>

      </div>
    </div>
    <div class="selector-container">
      <div id="theme-selector">
        <li class="nav-item dropdown" id="theme-button-list">
          <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
            <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="bd-theme-text">
<li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                Light
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                Dark
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
            <li>
              <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                Auto
                <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
            </li>
          </ul>
</li>
      </div>

      <div class="dropdown" id="instructor-dropdown">
        <button class="btn btn-secondary dropdown-toggle bordered-button" type="button" id="dropdownMenu1" data-bs-toggle="dropdown" aria-expanded="false">
          <i aria-hidden="true" class="icon" data-feather="eye"></i> Learner View <i data-feather="chevron-down"></i>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
<li><button class="dropdown-item" type="button" onclick="window.location.href='instructor/aio.html';">Instructor View</button></li>
        </ul>
</div>
    </div>
  </div>
  <hr></header><nav class="navbar navbar-expand-xl bottom-nav incubator" aria-label="Main Navigation"><div class="container-fluid nav-container">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle Navigation">
      <span class="navbar-toggler-icon"></span>
      <span class="menu-title">Menu</span>
    </button>
    <div class="nav-logo">
      <img class="small-logo" alt="Carpentries Incubator" src="assets/images/incubator-logo-sm.svg">
</div>
    <div class="lesson-title-md">
      Lesson Title
    </div>
    <div class="search-icon-sm">
      <!-- TODO: do not show until we have search
        <i role="img" aria-label="Search the All In One page" data-feather="search"></i>
      -->
    </div>
    <div class="desktop-nav">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
<li class="nav-item">
          <span class="lesson-title">
            Lesson Title
          </span>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="key-points.html">Key Points</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="reference.html#glossary">Glossary</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="profiles.html">Learner Profiles</a>
        </li>
        <li class="nav-item dropdown">
          <button class="nav-link dropdown-toggle" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            More <i data-feather="chevron-down"></i>
          </button>
          <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
<li><a class="dropdown-item" href="reference.html">Reference</a></li>
          </ul>
</li>
      </ul>
</div>
    <!--
    <form class="d-flex col-md-2 search-form">
      <fieldset disabled>
      <input class="form-control me-2 searchbox" type="search" placeholder="" aria-label="">
        <button class="btn btn-outline-success tablet-search-button"  type="submit">
          <i class="search-icon" data-feather="search" role="img" aria-label="Search the All In One page"></i>
        </button>
      </fieldset>
    </form>
    -->
    <a id="search-button" class="btn btn-primary" href="aio.html" role="button" aria-label="Search the All In One page">Search the All In One page</a>
  </div>
<!--/div.container-fluid -->
</nav><div class="col-md-12 mobile-title">
  Lesson Title
</div>

<aside class="col-md-12 lesson-progress"><div style="width: %" class="percentage">
    %
  </div>
  <div class="progress incubator">
    <div class="progress-bar incubator" role="progressbar" style="width: %" aria-valuenow="" aria-label="Lesson Progress" aria-valuemin="0" aria-valuemax="100">
    </div>
  </div>
</aside><div class="container">
      <div class="row">
        <!-- START: inst/pkgdown/templates/navbar.html -->
<div id="sidebar-col" class="col-lg-4">
  <div id="sidebar" class="sidebar">
      <nav aria-labelledby="flush-headingEleven"><button role="button" aria-label="close menu" alt="close menu" aria-expanded="true" aria-controls="sidebar" class="collapse-toggle" data-collapse="Collapse " data-episodes="Episodes ">
          <i class="search-icon" data-feather="x" role="img"></i>
        </button>
        <div class="sidebar-inner">
          <div class="row mobile-row" id="theme-row-mobile">
            <div class="col" id="theme-selector">
              <li class="nav-item dropdown" id="theme-button-list">
                <button class="btn btn-link nav-link px-0 px-lg-2 dropdown-toggle d-flex align-items-center" id="bd-theme" type="button" aria-expanded="false" data-bs-toggle="dropdown" data-bs-display="static" aria-label="Toggle theme (auto)">
                  <svg class="bi my-1 theme-icon-active"><use href="#circle-half"></use></svg><span class="d-lg-none ms-1" id="bd-theme-text">Toggle Theme</span>
                </button>
                <ul class="dropdown-menu dropdown-menu-right" aria-labelledby="bd-theme-text">
<li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="light" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#sun-fill"></use></svg>
                      Light
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center" data-bs-theme-value="dark" aria-pressed="false">
                      <svg class="bi me-2 theme-icon"><use href="#moon-stars-fill"></use></svg>
                      Dark
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                  <li>
                    <button type="button" class="btn dropdown-item d-flex align-items-center active" data-bs-theme-value="auto" aria-pressed="true">
                      <svg class="bi me-2 theme-icon"><use href="#circle-half"></use></svg>
                      Auto
                      <svg class="bi ms-auto d-none"><use href="#check2"></use></svg></button>
                  </li>
                </ul>
</li>
            </div>
          </div>
          <div class="row mobile-row">
            <div class="col">
              <div class="sidenav-view-selector">
                <div class="accordion accordion-flush" id="accordionFlush9">
                  <div class="accordion-item">
                    <h2 class="accordion-header" id="flush-headingNine">
                      <button class="accordion-button collapsed" id="instructor" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseNine" aria-expanded="false" aria-controls="flush-collapseNine">
                        <i id="eye" aria-hidden="true" class="icon" data-feather="eye"></i> Learner View
                      </button>
                    </h2>
                    <div id="flush-collapseNine" class="accordion-collapse collapse" aria-labelledby="flush-headingNine" data-bs-parent="#accordionFlush2">
                      <div class="accordion-body">
                        <a href="instructor/aio.html">Instructor View</a>
                      </div>
                    </div>
                  </div>
<!--/div.accordion-item-->
                </div>
<!--/div.accordion-flush-->
              </div>
<!--div.sidenav-view-selector -->
            </div>
<!--/div.col -->

            <hr>
</div>
<!--/div.mobile-row -->

          <div class="accordion accordion-flush" id="accordionFlush11">
            <div class="accordion-item">

              <button id="chapters" class="accordion-button show" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseEleven" aria-expanded="false" aria-controls="flush-collapseEleven">
                <h2 class="accordion-header chapters" id="flush-headingEleven">
                  EPISODES
                </h2>
              </button>
              <div id="flush-collapseEleven" class="accordion-collapse show collapse" aria-labelledby="flush-headingEleven" data-bs-parent="#accordionFlush11">

                <div class="accordion-body">
                  <div class="accordion accordion-flush" id="accordionFlush1">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading1">
        <a href="index.html">Summary and Setup</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush2">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading2">
        <a href="introduction.html">1. introduction</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush3">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading3">
        <a href="api-in-general.html">2. What is an API?</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush4">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading4">
        <a href="getting-data.html">3. GETting data</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

<div class="accordion accordion-flush" id="accordionFlush5">
  <div class="accordion-item">
    <div class="accordion-header" id="flush-heading5">
        <a href="post-statistics-denmark.html">4. Using POST</a>
    </div>
<!--/div.accordion-header-->

  </div>
<!--/div.accordion-item-->
</div>
<!--/div.accordion-flush-->

                </div>
              </div>
            </div>

            <hr class="half-width">
<div class="accordion accordion-flush resources" id="accordionFlush12">
              <div class="accordion-item">
                <h2 class="accordion-header" id="flush-headingTwelve">
                  <button class="accordion-button collapsed" id="resources" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapseTwelve" aria-expanded="false" aria-controls="flush-collapseTwelve">
                    RESOURCES
                  </button>
                </h2>
                <div id="flush-collapseTwelve" class="accordion-collapse collapse" aria-labelledby="flush-headingTwelve" data-bs-parent="#accordionFlush12">
                  <div class="accordion-body">
                    <ul>
<li>
                        <a href="key-points.html">Key Points</a>
                      </li>
                      <li>
                        <a href="reference.html#glossary">Glossary</a>
                      </li>
                      <li>
                        <a href="profiles.html">Learner Profiles</a>
                      </li>
                      <li><a href="reference.html">Reference</a></li>
                    </ul>
</div>
                </div>
              </div>
            </div>
            <hr class="half-width resources">
<a href="aio.html">See all in one page</a>


            <hr class="d-none d-sm-block d-md-none">
<div class="d-grid gap-1">

            </div>
          </div>
<!-- /div.accordion -->
        </div>
<!-- /div.sidebar-inner -->
      </nav>
</div>
<!-- /div.sidebar -->
  </div>
<!-- /div.sidebar-col -->
<!-- END:   inst/pkgdown/templates/navbar.html-->

        <!-- START: inst/pkgdown/templates/content-extra.html -->
  <div class="col-xl-8 col-lg-12 primary-content">
    <main id="main-content" class="main-content"><div class="container lesson-content">
        
        
<section id="aio-introduction"><p>Content from <a href="introduction.html">introduction</a></p>
<hr>
<p>Last updated on 2024-08-01 |

        <a href="https://github.com/chrbknudsen/R-api_new/edit/main/episodes/introduction.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“Is this an introduction to R?”</li>
<li>“What should I remember about R?”</li>
<li>“What new concepts are introduced?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Align expectations to required knowledge”</li>
<li>“Get an overview of the aims of this course”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="this-is-not-an-introduction-to-r">This is not an introduction to R<a class="anchor" aria-label="anchor" href="#this-is-not-an-introduction-to-r"></a>
<a class="anchor" aria-label="anchor" href="#this-is-not-an-introduction-to-r"></a>
</h2>
<hr class="half-width">
<p>This course assumes a certain level of knowledge about R. We are not
going to cover the basics, and we are assuming that you know how to use
the following functionalities in R before starting this course:</p>
<ul>
<li>Have R and R-studio installed.
<ul>
<li>Alternatively run everything on rstudio.cloud</li>
</ul>
</li>
<li>Know how to assign values to variables</li>
<li>Know what a function is, and how we pass input and parameters to
it</li>
<li>Be familiar with the %&gt;% operator</li>
<li>Know the basic verbs from dplyr of the tidyverse:
<ul>
<li>select</li>
<li>filter</li>
<li>mutate</li>
<li>arrange</li>
<li>summarise</li>
</ul>
</li>
<li>Be familiar with dataframes</li>
<li>Know how to install and load packages</li>
<li>Know how to comment your code</li>
<li>Know how to do math on variables</li>
<li>Get the concept of vectors</li>
<li>Subsetting vectors and dataframes
<ul>
<li>Using logical tests</li>
</ul>
</li>
<li>Use NA to encode missing values</li>
<li>Read in data from a csv/excel</li>
</ul>
<p>If any of these topics are unfamiliar, we strongly recommend that you
either take one of our introductory courses, read up on the curriculum
of one of them, or follow one of the many amazing courses you can find
online, before taking this course.</p>
</section><section><h2 class="section-heading" id="new-concepts-in-r">New concepts in R<a class="anchor" aria-label="anchor" href="#new-concepts-in-r"></a>
<a class="anchor" aria-label="anchor" href="#new-concepts-in-r"></a>
</h2>
<hr class="half-width">
<p>Three concepts are typically not covered in our introductions.</p>
<ul>
<li>Factors</li>
<li>dates</li>
<li>lists</li>
</ul>
<p>We will look at them when we need them.</p>
</section><section><h2 class="section-heading" id="what-is-covered">What is covered?<a class="anchor" aria-label="anchor" href="#what-is-covered"></a>
<a class="anchor" aria-label="anchor" href="#what-is-covered"></a>
</h2>
<hr class="half-width">
<p>We will look at how to extract data from APIs in general.</p>
<p>We start with the GET method, to get bad jokes.</p>
<p>The POST method allow more advanced searches in the API. We apply it
to the API provided by Statistics Denmark.</p>
<p>Finally the package <em>danstat</em> is introduced. This is provides
an easier way to interact with Statistics Denmark.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>“This course builds on previous courses and is not suitable for
absolute beginners.”</li>
<li>“We begin by accessing an API using lowlevel methods, and end by
applying them on another API.” questions:</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-api-in-general"><p>Content from <a href="api-in-general.html">What is an API?</a></p>
<hr>
<p>Last updated on 2024-08-01 |

        <a href="https://github.com/chrbknudsen/R-api_new/edit/main/episodes/api-in-general.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“What is an API?”</li>
<li>“How do our computer interact with servers?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Understand what an API do”</li>
<li>“Get to know the two main ways to get data from APIs”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<section><h2 class="section-heading" id="what-is-an-api">What is an API?<a class="anchor" aria-label="anchor" href="#what-is-an-api"></a>
<a class="anchor" aria-label="anchor" href="#what-is-an-api"></a>
</h2>
<hr class="half-width">
<p>An API is an Application Programming Interface. It is a way of making
applications, in our case an R-script, able to communicate with another
application typically an online database.</p>
<p>What we want to be able to do, is to let our own application, our
R-script, send a command to a remote application, an online database, in
order to retrieve specific data.</p>
<p>And we want to read the answer we get in return.</p>
<p>This is equivalent to requesting a page from a webserver, something
we have all done.</p>
<p>Webservers and browsers communicate using the HTTP protocol, and the
mechanics of this communication can be visualized like this:</p>
<figure><img src="images/http-structure.png" alt="Structure of what is happening behind the scenes when we request a webpage" class="figure mx-auto d-block"><div class="figcaption">Structure of what is happening behind the scenes
when we request a webpage</div>
</figure><ul>
<li><p>When we type in an URL in our browser, it translates that URL to
a HTTP-request.</p></li>
<li><p>The browser sends that HTTP-request to a webserver. The request
contains information about the page we need, but in the “header” of the
request, there is a lot of other information. The version of browser we
are using and cookies, to just mention two. The most important might be
information about what type of response we would like.</p></li>
<li><p>The webserver interpret the request, and retrieves the
data.</p></li>
<li><p>After that, the webserver sends both the status of the request
(hopefully 200 - which is short for “everything is OK”), and the
data.</p></li>
<li><p>The browser receives the data, and displays it as a
webpage.</p></li>
</ul>
<p>When we are working with APIs we cut out the user. We have a script
that needs some data. We write code that defines, and then send a
request til a server, specifying which data we need. The server extracts
the needed data, and returns it to the script.</p>
</section><section><h2 class="section-heading" id="so---how-do-we-do-that">So - how do we do that?<a class="anchor" aria-label="anchor" href="#so---how-do-we-do-that"></a>
<a class="anchor" aria-label="anchor" href="#so---how-do-we-do-that"></a>
</h2>
<hr class="half-width">
<p>Looking closer at the illustration above, we can see that we send a
request to the server. That request contains several parts.</p>
<p><em>The request line.</em> That contains the method we are using to
communicate with the server, the adress and path of the server, and the
information about the version of HTTP we are using to communicate with
the server.</p>
<p><em>The header.</em> Headers are meta information about our request.
It contains information about who we are, the type of browser we are
using and much more.</p>
<p><em>The body.</em> This is really the message that we are sending to
the server. Where the request line tells our computer where to we are
sending our request, and the header provides information about the
request, the body is the actual message we are sending to the
server.</p>
<p>The trick is now to make the API understand what data we would like
to get back from it.</p>
</section><section><h2 class="section-heading" id="two-types-of-requests">Two types of requests<a class="anchor" aria-label="anchor" href="#two-types-of-requests"></a>
<a class="anchor" aria-label="anchor" href="#two-types-of-requests"></a>
</h2>
<hr class="half-width">
<p>Two main types of requests are used when communicating with APIs, and
they primarily concerns how we tell the API what data we would like.</p>
<p>In a <em>GET</em> request, we encode what we would like returned in
the URL. You probably know that way already.</p>
<p>The URL “<a href="https://icanhazdadjoke.com/search?term=dog" class="external-link uri">https://icanhazdadjoke.com/search?term=dog</a>” is asking
the server to search for the term “dog”. What we are searching for, is
placed directly in the URL.</p>
<p>What we are sending to the server looks like this:</p>
<figure><img src="images/GET-headers.png" alt="GET header" class="figure mx-auto d-block"><div class="figcaption">GET header</div>
</figure><p>In a <em>POST</em> request, that information is stored in the body of
the request.</p>
<p>That looks like this:</p>
<figure><img src="images/POST-headers.png" alt="POST header" class="figure mx-auto d-block"><div class="figcaption">POST header</div>
</figure><p>Note that the main difference between these two sets of headers,
besides the difference in GET and POST, is that there is a <em>body</em>
in the POST version. This is where the actual search is placed, rather
than in the URL.</p>
<p>Almost all APIs support one or both of these methods.</p>
<p>The GET method is intuitively easy to understand, and it is
relatively easy to edit the URL to search for something else. On the
other hand there are limitations to what we can search for. Everything
must be text, and there are limitations on the length of the search as
well.</p>
<p>The POST method allow us to search for arbitrarily many parameters,
and can handle many different data types - because we can put almost any
kind of data into the body part of the request. The POST method is also
more secure, because the body can be encrypted during transport from our
computer to the server. This is also the method we need to use should
the API require a login.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>“Getting data from an API is equivalent to requesting a
webpage”</li>
<li>“GET requests specify what data we want to retrieve in the URL”</li>
<li>“POST requests specify what data we want to retrieve in the body of
the request.”</li>
<li>“Both requests have headers that we can manipulate to get what we
want.”</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-getting-data"><p>Content from <a href="getting-data.html">GETting data</a></p>
<hr>
<p>Last updated on 2024-08-01 |

        <a href="https://github.com/chrbknudsen/R-api_new/edit/main/episodes/getting-data.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>How do I get data from an API using the GET method?</li>
<li>Is there a way to modify headers, to get a specific type of
result?</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>Learn how to retrieve data using the GET method</li>
<li>Learn how to adjust headers to get desired result</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Please note: These pages are autogenerated. Some of the API-calls may
fail during that process. We are figuring out what to do about it, but
please excuse us for any red errors on the pages for the time being.</p>
<section><h2 class="section-heading" id="using-get">Using GET<a class="anchor" aria-label="anchor" href="#using-get"></a>
<a class="anchor" aria-label="anchor" href="#using-get"></a>
</h2>
<hr class="half-width">
<p>The site icanhazdadjoke.com offers a wide selection of dad-jokes.</p>
<div id="dad-jokes" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="dad-jokes" class="callout-inner">
<h3 class="callout-title">Dad jokes<a class="anchor" aria-label="anchor" href="#dad-jokes"></a>
</h3>
<div class="callout-content">
<p>a wholesome joke of the type said to be told by fathers with a
punchline that is often an obvious or predictable pun or play on words
and usually judged to be endearingly corny or unfunny <a href="https://www.merriam-webster.com/dictionary/dad%20joke" class="external-link uri">https://www.merriam-webster.com/dictionary/dad%20joke</a></p>
</div>
</div>
</div>
<p>In addition to the website, an API is available that can be accessed
using the GET method.</p>
<p>The GET method is a generic procedure, we need a function that
actually handles the behind-the-scenes-stuff for us. The library
<em>httr</em> have an implementation:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">httr</span><span class="op">)</span></span></code></pre>
</div>
<p>Taking a quick look at the <a href="https://icanhazdadjoke.com/api" class="external-link">documentation</a> we first try GET
directly:</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">GET</span><span class="op">(</span><span class="st">"https://icanhazdadjoke.com/"</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Response [https://icanhazdadjoke.com/]
  Date: 2024-08-01 11:30
  Status: 200
  Content-Type: text/html; charset=utf-8
  Size: 9.87 kB
&lt;!DOCTYPE html&gt;
&lt;html lang="en"&gt;
&lt;head&gt;
&lt;meta charset="utf-8"&gt;
&lt;meta http-equiv="X-UA-Compatible" content="IE=edge"&gt;
&lt;meta name="viewport" content="width=device-width, initial-scale=1, minimum-s...
&lt;meta name="description" content="The largest collection of dad jokes on the ...
&lt;meta name="author" content="C653 Labs" /&gt;
&lt;meta name="keywords" content="dad,joke,funny,slack,alexa" /&gt;
&lt;meta property="og:site_name" content="icanhazdadjoke" /&gt;
...</code></pre>
</div>
<p>What is returned is the response from the server. That includes much
more than what we are looking for. Notable is the “Status” part, which
we are told is “200”, which is server-lingo for “everything is OK”.</p>
<p>And what do we get? We get a webpage. We can see that the content is
<em>DOCTYPE html</em>. That was not really what we were looking for.
HTML is not that easy to work with, and contains a lot of extranious
information that we do not need.</p>
<p>Even if the GET method is relatively simple to work with, we need to
add a bit more. Again taking a look at the documentation, it appears
that we need to tell the API, that we would like a specific type of
response, rather than the default html, more specifically
“text/plain”.</p>
<p><em>httr</em> has helper functions to assist us. The one we need here
is <em>accept()</em> We now use that to tell the server, that we really
want a response in just text:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">GET</span><span class="op">(</span><span class="st">"https://icanhazdadjoke.com/"</span>, <span class="fu">accept</span><span class="op">(</span><span class="st">"text/plain"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Response [https://icanhazdadjoke.com/]
  Date: 2024-08-01 11:30
  Status: 200
  Content-Type: text/plain
  Size: 65 B</code></pre>
</div>
<p>We still get the response from the server, telling us that Status is
200, and everything is OK. But where is our dad-joke?</p>
<p>It is hidden in the content of the response. It is sent to us as
binary code, so we are using the <em>content()</em> function, also from
<em>httr</em> to extract it:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">content</span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "What do you call two guys hanging out by your window? Kurt &amp; Rod."</code></pre>
</div>
<p>There is a little warning about the encoding of the string. But now
we have a dad-joke!</p>
<p>What if we need to retrieve a specific joke? All the jokes has an ID,
that we can use for that. If we want to find that, we need a bit more
information about the joke. We can get that by specifying that we would
like the result of our GET-request returned as JSON.</p>
<div id="json" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="json" class="callout-inner">
<h3 class="callout-title">JSON<a class="anchor" aria-label="anchor" href="#json"></a>
</h3>
<div class="callout-content">
<p>JSON (JavaScript Object Notation) is a format for structuring, in
principle, any kind for text, structured in almost any way. It consists
of pairs of strings, one denoting the name of the data we are looking
at, and one containing the content of that data. Each set of data fields
are encapsulated in curly braces, and a data field can have subfields,
also encapsulated in curly braces. It can look like this:</p>
<p>{ “firstName”: “John”, “lastName”: “Smith”, “phoneNumbers”:{ “type”:
“home”, “number”: “212 555-1234” }, { “type”: “office”, “number”: “646
555-4567” } }</p>
<p>JSON is readable for both humans and computers, but can be a bit
tricky to convert to dataframes if there are a lot of nested fields.</p>
</div>
</div>
</div>
<p>Looking at the documentation, we see an example, which indicates that
what we should tell the server that we accept, should be
“application/json”. The <em>httr</em> library contains helper functions
to assist us in manipulating the header. We use <em>accept()</em> that
sets the <em>accept</em> part of the header:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">GET</span><span class="op">(</span><span class="st">"https://icanhazdadjoke.com/"</span>, <span class="fu">accept</span><span class="op">(</span><span class="st">"application/json"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Response [https://icanhazdadjoke.com/]
  Date: 2024-08-01 11:30
  Status: 200
  Content-Type: application/json
  Size: 129 B
{"id":"x5M799Ufib","joke":"I wish I could clean mirrors for a living. It's ju...</code></pre>
</div>
<p>Again - everything is nice and 200 = OK.</p>
<p>We also see a truncated version of the actual joke.</p>
<p>Let us use the content() function to extract the content:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">content</span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$id
[1] "x5M799Ufib"

$joke
[1] "I wish I could clean mirrors for a living. It's just something I can see myself doing."

$status
[1] 200</code></pre>
</div>
<p>This data is returned as a list, which is the R-default way of
handling any kind of data. Status is repeated, and now we have an id. We
can use that to extract the same joke again.</p>
<p>NOTE: The joke returned is chosen at random. The id used here will
probably be different from what we found above.</p>
<p>The way to retrieve a specific joke is to GET the URL:</p>
<p><code>GET https://icanhazdadjoke.com/j/&lt;joke_id&gt;</code></p>
<p>Where we replace the <em>joke_id</em> with the specific joke we want.
Remember to specify the result that we want:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">GET</span><span class="op">(</span><span class="st">"https://icanhazdadjoke.com/j/lGJmrrzAsc"</span>,  <span class="fu">accept</span><span class="op">(</span><span class="st">"text/plain"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">content</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "A termite walks into a bar and asks “Is the bar tender here?”"</code></pre>
</div>
<p>We can also search for words in jokes. The documentation tells us,
that we should send our GET request to the URL</p>
<p><a href="https://icanhazdadjoke.com/search" class="external-link uri">https://icanhazdadjoke.com/search</a></p>
<p>And in the examples we get the hint, that we should format the URL
as:</p>
<p><a href="https://icanhazdadjoke.com/search?term=" class="external-link uri">https://icanhazdadjoke.com/search?term=</a><term></term></p>
<p>Dogs are always fun, let us search for dad jokes about dogs. Specify
the type of result we want, pipe the response to the content() function
and save it to <em>result</em>:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">GET</span><span class="op">(</span><span class="st">"https://icanhazdadjoke.com/search?term=dog"</span>,</span>
<span>              <span class="fu">accept</span><span class="op">(</span><span class="st">"application/json"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>          <span class="fu">content</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$current_page
[1] 1

$limit
[1] 20

$next_page
[1] 1

$previous_page
[1] 1

$results
$results[[1]]
$results[[1]]$id
[1] "82wHlbaapzd"

$results[[1]]$joke
[1] "Me: If humans lose the ability to hear high frequency volumes as they get older, can my 4 week old son hear a dog whistle?\r\n\r\nDoctor: No, humans can never hear that high of a frequency no matter what age they are.\r\n\r\nMe: Trick question... dogs can't whistle."


$results[[2]]
$results[[2]]$id
[1] "YvkV8xXnjyd"

$results[[2]]$joke
[1] "Why did the cowboy have a weiner dog? Somebody told him to get a long little doggy."


$results[[3]]
$results[[3]]$id
[1] "lyk3EIBQfxc"

$results[[3]]$joke
[1] "I went to the zoo the other day, there was only one dog in it. It was a shitzu."


$results[[4]]
$results[[4]]$id
[1] "DIeaUDlbUDd"

$results[[4]]$joke
[1] "“My Dog has no nose.” “How does he smell?” “Awful”"


$results[[5]]
$results[[5]]$id
[1] "EBQfiyXD5ob"

$results[[5]]$joke
[1] "what do you call a dog that can do magic tricks? a labracadabrador"


$results[[6]]
$results[[6]]$id
[1] "obhFBljb2g"

$results[[6]]$joke
[1] "I adopted my dog from a blacksmith. As soon as we got home he made a bolt for the door."


$results[[7]]
$results[[7]]$id
[1] "89MZLmWnWvc"

$results[[7]]$joke
[1] "I can't take my dog to the pond anymore because the ducks keep attacking him. That's what I get for buying a pure bread dog."


$results[[8]]
$results[[8]]$id
[1] "GtH6E6UD5Ed"

$results[[8]]$joke
[1] "What kind of dog lives in a particle accelerator? A Fermilabrador Retriever."


$results[[9]]
$results[[9]]$id
[1] "R7UfaahVfFd"

$results[[9]]$joke
[1] "My dog used to chase people on a bike a lot. It got so bad I had to take his bike away."


$results[[10]]
$results[[10]]$id
[1] "71wsPKeF6h"

$results[[10]]$joke
[1] "What did the dog say to the two trees? Bark bark."


$results[[11]]
$results[[11]]$id
[1] "sPRnOfiyAAd"

$results[[11]]$joke
[1] "At the boxing match, the dad got into the popcorn line and the line for hot dogs, but he wanted to stay out of the punchline."


$results[[12]]
$results[[12]]$id
[1] "AQn3wPKeqrc"

$results[[12]]$joke
[1] "It was raining cats and dogs the other day. I almost stepped in a poodle."


$results[[13]]
$results[[13]]$id
[1] "Lmjqzsr49pb"

$results[[13]]$joke
[1] "What did the Zen Buddist say to the hotdog vendor? Make me one with everything."



$search_term
[1] "dog"

$status
[1] 200

$total_jokes
[1] 13

$total_pages
[1] 1</code></pre>
</div>
<p>This is in JSON format. It is clear that the jokes are in the
$results part of that datastructure. How can we get that to a data
frame?</p>
<p>the content() function can treat the content of our response in
different ways. If we treat it as text, the function fromJSON from the
library <em>jsonlite</em>, can convert it to a data frame. We begin by
loading the library:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">library</span><span class="op">(</span><span class="va">jsonlite</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>
Attaching package: 'jsonlite'</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>The following object is masked from 'package:purrr':

    flatten</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">GET</span><span class="op">(</span><span class="st">"https://icanhazdadjoke.com/search?term=dog"</span>, <span class="fu">accept</span><span class="op">(</span><span class="st">"application/json"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">content</span><span class="op">(</span>as<span class="op">=</span><span class="st">"text"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fromJSON</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$current_page
[1] 1

$limit
[1] 20

$next_page
[1] 1

$previous_page
[1] 1

$results
            id
1  82wHlbaapzd
2  YvkV8xXnjyd
3  lyk3EIBQfxc
4  DIeaUDlbUDd
5  EBQfiyXD5ob
6   obhFBljb2g
7  89MZLmWnWvc
8  GtH6E6UD5Ed
9  R7UfaahVfFd
10  71wsPKeF6h
11 sPRnOfiyAAd
12 AQn3wPKeqrc
13 Lmjqzsr49pb
                                                                                                                                                                                                                                                                         joke
1  Me: If humans lose the ability to hear high frequency volumes as they get older, can my 4 week old son hear a dog whistle?\r\n\r\nDoctor: No, humans can never hear that high of a frequency no matter what age they are.\r\n\r\nMe: Trick question... dogs can't whistle.
2                                                                                                                                                                                         Why did the cowboy have a weiner dog? Somebody told him to get a long little doggy.
3                                                                                                                                                                                             I went to the zoo the other day, there was only one dog in it. It was a shitzu.
4                                                                                                                                                                                                                          “My Dog has no nose.” “How does he smell?” “Awful”
5                                                                                                                                                                                                          what do you call a dog that can do magic tricks? a labracadabrador
6                                                                                                                                                                                     I adopted my dog from a blacksmith. As soon as we got home he made a bolt for the door.
7                                                                                                                                                I can't take my dog to the pond anymore because the ducks keep attacking him. That's what I get for buying a pure bread dog.
8                                                                                                                                                                                                What kind of dog lives in a particle accelerator? A Fermilabrador Retriever.
9                                                                                                                                                                                     My dog used to chase people on a bike a lot. It got so bad I had to take his bike away.
10                                                                                                                                                                                                                          What did the dog say to the two trees? Bark bark.
11                                                                                                                                              At the boxing match, the dad got into the popcorn line and the line for hot dogs, but he wanted to stay out of the punchline.
12                                                                                                                                                                                                  It was raining cats and dogs the other day. I almost stepped in a poodle.
13                                                                                                                                                                                            What did the Zen Buddist say to the hotdog vendor? Make me one with everything.

$search_term
[1] "dog"

$status
[1] 200

$total_jokes
[1] 13

$total_pages
[1] 1</code></pre>
</div>
<p>We have now seen how to send a request to an API, with search terms
embedded in the URL.</p>
<p>We have seen how to add an argument to the GET function, that
specifies the type of result we would like, effectively by adding
something to the header of our request.</p>
<p>And we have seen how to extract the results, and get them into a
dataframe.</p>
<p>Next, we are going to take a look on how we get results using the
POST method, on an API that provides more factual and serious, but not
so funny data.</p>
<div id="exercise" class="callout challenge">
<div class="callout-square">
<i class="callout-icon" data-feather="zap"></i>
</div>
<div id="exercise" class="callout-inner">
<h3 class="callout-title">Exercise<a class="anchor" aria-label="anchor" href="#exercise"></a>
</h3>
<div class="callout-content">
<p>Request dad jokes about cats</p>
</div>
</div>
</div>
<div id="accordionSolution1" class="accordion challenge-accordion accordion-flush">
<div class="accordion-item">
<button class="accordion-button solution-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSolution1" aria-expanded="false" aria-controls="collapseSolution1">
  <h4 class="accordion-header" id="headingSolution1"> Show me the solution </h4>
</button>
<div id="collapseSolution1" class="accordion-collapse collapse" aria-labelledby="headingSolution1" data-bs-parent="#accordionSolution1">
<div class="accordion-body">
<div class="codewrapper sourceCode" id="cb24">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">GET</span><span class="op">(</span><span class="st">"https://icanhazdadjoke.com/search?term=dog"</span>, <span class="fu">accept</span><span class="op">(</span><span class="st">"application/json"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">content</span><span class="op">(</span>as<span class="op">=</span><span class="st">"text"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span><span class="fu">fromJSON</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$current_page
[1] 1

$limit
[1] 20

$next_page
[1] 1

$previous_page
[1] 1

$results
            id
1  YvkV8xXnjyd
2  82wHlbaapzd
3  EBQfiyXD5ob
4  GtH6E6UD5Ed
5   obhFBljb2g
6  89MZLmWnWvc
7   71wsPKeF6h
8  R7UfaahVfFd
9  lyk3EIBQfxc
10 DIeaUDlbUDd
11 AQn3wPKeqrc
12 sPRnOfiyAAd
13 Lmjqzsr49pb
                                                                                                                                                                                                                                                                         joke
1                                                                                                                                                                                         Why did the cowboy have a weiner dog? Somebody told him to get a long little doggy.
2  Me: If humans lose the ability to hear high frequency volumes as they get older, can my 4 week old son hear a dog whistle?\r\n\r\nDoctor: No, humans can never hear that high of a frequency no matter what age they are.\r\n\r\nMe: Trick question... dogs can't whistle.
3                                                                                                                                                                                                          what do you call a dog that can do magic tricks? a labracadabrador
4                                                                                                                                                                                                What kind of dog lives in a particle accelerator? A Fermilabrador Retriever.
5                                                                                                                                                                                     I adopted my dog from a blacksmith. As soon as we got home he made a bolt for the door.
6                                                                                                                                                I can't take my dog to the pond anymore because the ducks keep attacking him. That's what I get for buying a pure bread dog.
7                                                                                                                                                                                                                           What did the dog say to the two trees? Bark bark.
8                                                                                                                                                                                     My dog used to chase people on a bike a lot. It got so bad I had to take his bike away.
9                                                                                                                                                                                             I went to the zoo the other day, there was only one dog in it. It was a shitzu.
10                                                                                                                                                                                                                         “My Dog has no nose.” “How does he smell?” “Awful”
11                                                                                                                                                                                                  It was raining cats and dogs the other day. I almost stepped in a poodle.
12                                                                                                                                              At the boxing match, the dad got into the popcorn line and the line for hot dogs, but he wanted to stay out of the punchline.
13                                                                                                                                                                                            What did the Zen Buddist say to the hotdog vendor? Make me one with everything.

$search_term
[1] "dog"

$status
[1] 200

$total_jokes
[1] 13

$total_pages
[1] 1</code></pre>
</div>
</div>
</div>
</div>
</div>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>200 is the internet code for everything is OK</li>
<li>GET requests can be adjusted to specify desired result</li>
<li>Dad jokes are not really that good.</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section><section id="aio-post-statistics-denmark"><p>Content from <a href="post-statistics-denmark.html">Using POST</a></p>
<hr>
<p>Last updated on 2024-08-01 |

        <a href="https://github.com/chrbknudsen/R-api_new/edit/main/episodes/post-statistics-denmark.Rmd" class="external-link">Edit this page <i aria-hidden="true" data-feather="edit"></i></a></p>
<div class="text-end">
          <button role="button" aria-pressed="false" tabindex="0" id="expand-code" class="pull-right" data-expand="Expand All Solutions " data-collapse="Collapse All Solutions "> Expand All Solutions <i aria-hidden="true" data-feather="plus"></i></button>
        </div>
<div class="overview card">
<h2 class="card-header">Overview</h2>
<div class="row g-0">
<div class="col-md-4">
<div class="card-body">
<div class="inner">
<h3 class="card-title">Questions</h3>
<ul>
<li>“How do I get data from an API using the POST method?”</li>
</ul>
</div>
</div>
</div>
<div class="col-md-8">
<div class="card-body">
<div class="inner bordered">
<h3 class="card-title">Objectives</h3>
<ul>
<li>“Connect to Statistics Denmark, and extract data”</li>
<li>“Create a list of lists to control the variables to be
extracted”</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<p>Please note: These pages are autogenerated. Some of the API-calls may
fail during that process. We are figuring out what to do about it, but
please excuse us for any red errors on the pages for the time being.</p>
<section><h2 class="section-heading" id="getting-data-from-statistics-denmark">Getting data from Statistics Denmark<a class="anchor" aria-label="anchor" href="#getting-data-from-statistics-denmark"></a>
<a class="anchor" aria-label="anchor" href="#getting-data-from-statistics-denmark"></a>
</h2>
<hr class="half-width">
<p>The API from statistics Denmark can accept GET requests. But they
recommend using POST instead. That allows us to do more advanced
searches for data easier.</p>
<p>We are going to write a POST-request (with a little help from R), to
retrieve data from Statistics Denmark.</p>
<p>But before we can do that, we need to know how the SD-API expects to
receive data.</p>
<p>Hopefully we can get that by reading the documentation. We can find
that here:</p>
<p><a href="https://www.dst.dk/en/Statistik/brug-statistikken/muligheder-i-statistikbanken/api" class="external-link uri">https://www.dst.dk/en/Statistik/brug-statistikken/muligheder-i-statistikbanken/api</a></p>
<p>That was confusing!</p>
<p>The main points:</p>
<p>First: Statistics Denmark provides four “functions”, or
<em>endpoints</em>. This is equivalent to the URL we requested data from
using the GET method.</p>
<figure><img src="images/DSfunctions.png" alt="“functions or endpoints at the API" class="figure mx-auto d-block"><div class="figcaption">“functions or endpoints at the API</div>
</figure><ul>
<li>The first is the “web”-site we have to send requests to if we want
information on the subjects in Statistics Denmark.</li>
<li>In the second we get information about which tables are available
for a given subject.</li>
<li>The third will provide metadata on a table.</li>
<li>When we finally need the data, we will visit the last endpoint.</li>
</ul>
<p>Secondly: We need to provide a body containing search parameters in a
format like this:</p>
<div class="codewrapper sourceCode" id="cb1">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">{</span></span>
<span>   <span class="st">"table"</span><span class="op">:</span> <span class="st">"folk1c"</span></span>
<span><span class="op">}</span></span></code></pre>
</div>
<p>Let us look at how to do this, by sending a request to
<code>subjects</code>.</p>
<p>The endpoint was</p>
<div class="codewrapper sourceCode" id="cb2">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endpoint</span> <span class="op">&lt;-</span> <span class="st">"http://api.statbank.dk/v1/subjects"</span></span></code></pre>
</div>
<p>We will now need to construct a named list for the content of the
body that we send along with our request.</p>
<p>This is a new datastructure that we have not encountered before.</p>
<p>Vectors are annoying because they can only contain one datatype. And
dataframes must be rectangular.</p>
<p>A list allows us to store basically anything. The reason that we do
not use them for everything is that they are a bit more difficult to
work with.</p>
<div class="codewrapper sourceCode" id="cb3">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">our_body</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>lang <span class="op">=</span> <span class="st">"en"</span>, recursive <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                  includeTables <span class="op">=</span> <span class="cn">FALSE</span>, subjects <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre>
</div>
<p>This list contains four elements, with names. - The first,
<code>lang</code>, contains a character vector (length 1), containing
“en”, the language that we want Statistics Denmark to use when returning
data. - <code>recursive</code> and <code>includeTables</code> are
logical values, both false. - <code>subjects</code> is a special value,
NULL. This is not a missing value, there simply isn’t anything there.
But this nothing does have a name.</p>
<div id="lists" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="lists" class="callout-inner">
<h3 class="callout-title">lists<a class="anchor" aria-label="anchor" href="#lists"></a>
</h3>
<div class="callout-content">
<p>Lists are subset in a special way. If we want the first element in
<code>our_body</code>, we can use the usual bracket notation:</p>
<div class="codewrapper sourceCode" id="cb4">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">our_body</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$lang
[1] "en"</code></pre>
</div>
<p>If we want the actual value of element 1, we use a double bracket
notation:</p>
<div class="codewrapper sourceCode" id="cb6">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">our_body</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "en"</code></pre>
</div>
</div>
</div>
</div>
<p>Now we have the two things we need, an endpoint to send a request,
and a body containing what we want returned.</p>
<p>Let us try it:</p>
<div class="codewrapper sourceCode" id="cb8">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">httr</span><span class="fu">::</span><span class="fu">POST</span><span class="op">(</span><span class="va">endpoint</span>, body<span class="op">=</span><span class="va">our_body</span>, encode <span class="op">=</span> <span class="st">"json"</span><span class="op">)</span></span></code></pre>
</div>
<p>We ask to get the result in json, a speciel datastructure that is
able to contain almost anything.</p>
<p>Let us look at the result:</p>
<div class="codewrapper sourceCode" id="cb9">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Response [https://api.statbank.dk/v1/subjects]
  Date: 2024-08-01 11:30
  Status: 200
  Content-Type: text/json; charset=utf-8
  Size: 884 B</code></pre>
</div>
<p>Both informative. And utterly useless. The informative information is
that our request succeeded (cave - it might not succeed on this
webpage). We can see that in the status. 200 is an internet code for
success.</p>
<p>Let us get the content of the result, which is what we actually
want:</p>
<div class="codewrapper sourceCode" id="cb11">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">content</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[1] "[{\"id\":\"1\",\"description\":\"People\",\"active\":true,\"hasSubjects\":true,\"subjects\":[]},{\"id\":\"2\",\"description\":\"Labour and income\",\"active\":true,\"hasSubjects\":true,\"subjects\":[]},{\"id\":\"3\",\"description\":\"Economy\",\"active\":true,\"hasSubjects\":true,\"subjects\":[]},{\"id\":\"4\",\"description\":\"Social conditions\",\"active\":true,\"hasSubjects\":true,\"subjects\":[]},{\"id\":\"5\",\"description\":\"Education and research\",\"active\":true,\"hasSubjects\":true,\"subjects\":[]},{\"id\":\"6\",\"description\":\"Business\",\"active\":true,\"hasSubjects\":true,\"subjects\":[]},{\"id\":\"7\",\"description\":\"Transport\",\"active\":true,\"hasSubjects\":true,\"subjects\":[]},{\"id\":\"8\",\"description\":\"Culture and leisure\",\"active\":true,\"hasSubjects\":true,\"subjects\":[]},{\"id\":\"9\",\"description\":\"Environment and energy\",\"active\":true,\"hasSubjects\":true,\"subjects\":[]},{\"id\":\"19\",\"description\":\"Other\",\"active\":true,\"hasSubjects\":true,\"subjects\":[]}]"</code></pre>
</div>
<p>More informative, but not really easy to read.</p>
<p>The library <code>jsonlite</code> has a function that converts this
to something readable:</p>
<div class="codewrapper sourceCode" id="cb13">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">content</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fromJSON</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>   id            description active hasSubjects subjects
1   1                 People   TRUE        TRUE     NULL
2   2      Labour and income   TRUE        TRUE     NULL
3   3                Economy   TRUE        TRUE     NULL
4   4      Social conditions   TRUE        TRUE     NULL
5   5 Education and research   TRUE        TRUE     NULL
6   6               Business   TRUE        TRUE     NULL
7   7              Transport   TRUE        TRUE     NULL
8   8    Culture and leisure   TRUE        TRUE     NULL
9   9 Environment and energy   TRUE        TRUE     NULL
10 19                  Other   TRUE        TRUE     NULL</code></pre>
</div>
<p>A nice dataframe with the ten major subjects in the databases of
Statistics Denmark.</p>
<p>Subject 1 contains information about populations and elections.</p>
<p>There are sub-subjects under that. We can see that in the column
<code>hasSubjects</code></p>
<p>We now modify our body that we send with the request, to return
information about the first subject.</p>
<p>We need to make sure that the number of the subject, <code>1</code>
is intepreted as it is. This is a little bit of mysterious handwaving -
we simply put the 1 inside the function <code>I()</code> and stuff
works.</p>
<div class="codewrapper sourceCode" id="cb15">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">our_body</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>lang <span class="op">=</span> <span class="st">"en"</span>, recursive <span class="op">=</span> <span class="cn">F</span>, </span>
<span>                  includeTables <span class="op">=</span> <span class="cn">F</span>, subjects <span class="op">=</span> <span class="fu">I</span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div id="i" class="callout">
<div class="callout-square">
<i class="callout-icon" data-feather="bell"></i>
</div>
<div id="i" class="callout-inner">
<h3 class="callout-title">I()<a class="anchor" aria-label="anchor" href="#i"></a>
</h3>
<div class="callout-content">
<p>I() isolates - or insulates - the contents of I() from the gaze of
R’s parsing code. Basically it prevents R from doing stuff to the
content that we dont want it to. In this specific case, the POST()
function would convert the vector 1, with length 1, to a scalar, the
more basic data type in R, that hold only one, single, atomic value at a
time.</p>
</div>
</div>
</div>
<p>Note that it is important that we tell the POST function that the
body is the body:</p>
<div class="codewrapper sourceCode" id="cb16">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">POST</span><span class="op">(</span><span class="va">endpoint</span>, body<span class="op">=</span><span class="va">our_body</span>, encode <span class="op">=</span> <span class="st">"json"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">content</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fromJSON</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>  id description active hasSubjects
1  1      People   TRUE        TRUE
                                                                                                                                                                                                                                                      subjects
1 3401, 3407, 3410, 3415, 3412, 3411, 3428, 3409, Population, Households, families and children, Migration, Housing, Health, Democracy, National church, Names, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TRUE</code></pre>
</div>
<p>Not that easy to see in this format, but the data frame contains a
data frame. That is, in the column <code>subjects</code> the content is
a data frame.</p>
<p>We pick that out using the $-notation:</p>
<div class="codewrapper sourceCode" id="cb18">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">$</span><span class="va">subjects</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[1]]
    id                       description active hasSubjects subjects
1 3401                        Population   TRUE        TRUE     NULL
2 3407 Households, families and children   TRUE        TRUE     NULL
3 3410                         Migration   TRUE        TRUE     NULL
4 3415                           Housing   TRUE        TRUE     NULL
5 3412                            Health   TRUE        TRUE     NULL
6 3411                         Democracy   TRUE        TRUE     NULL
7 3428                   National church   TRUE        TRUE     NULL
8 3409                             Names   TRUE        TRUE     NULL</code></pre>
</div>
<p>These are the sub-subjects of subject 1.</p>
<p>Let us look closer at 3401, Population.</p>
<p>Again, we modify the call we send to the endpoint:</p>
<div class="codewrapper sourceCode" id="cb20">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">our_body</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>lang <span class="op">=</span> <span class="st">"en"</span>, recursive <span class="op">=</span> <span class="cn">F</span>, </span>
<span>                  includeTables <span class="op">=</span> <span class="cn">F</span>, subjects <span class="op">=</span> <span class="fu">I</span><span class="op">(</span><span class="fl">3401</span><span class="op">)</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb21">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">POST</span><span class="op">(</span><span class="va">endpoint</span>, body<span class="op">=</span><span class="va">our_body</span>, encode <span class="op">=</span> <span class="st">"json"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">content</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fromJSON</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>    id description active hasSubjects
1 3401  Population   TRUE        TRUE
                                                                                                                                                                                                                                                                                              subjects
1 20021, 20024, 20022, 20019, 20017, 20018, 20014, 20015, Population figures, Immigrants and their descendants, Population projections, Adoptions, Births, Fertility, Deaths, Life expectancy, TRUE, TRUE, TRUE, FALSE, TRUE, TRUE, TRUE, TRUE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE</code></pre>
</div>
<p>We delve deeper into it:</p>
<div class="codewrapper sourceCode" id="cb23">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span><span class="op">$</span><span class="va">subjects</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>[[1]]
     id                      description active hasSubjects subjects
1 20021               Population figures   TRUE       FALSE     NULL
2 20024 Immigrants and their descendants   TRUE       FALSE     NULL
3 20022           Population projections   TRUE       FALSE     NULL
4 20019                        Adoptions  FALSE       FALSE     NULL
5 20017                           Births   TRUE       FALSE     NULL
6 20018                        Fertility   TRUE       FALSE     NULL
7 20014                           Deaths   TRUE       FALSE     NULL
8 20015                  Life expectancy   TRUE       FALSE     NULL</code></pre>
</div>
<p>And now we are at the bottom. 20021 Population figures does not have
any sub-sub-subjects.</p>
<p>Next, let us take a look at the tables contained under subject
20021.</p>
<p>We need the next endpoint, which provides information about tables
under a subject:</p>
<div class="codewrapper sourceCode" id="cb25">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endpoint</span> <span class="op">&lt;-</span> <span class="st">"http://api.statbank.dk/v1/tables"</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb26">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">our_body</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>lang <span class="op">=</span> <span class="st">"en"</span>, subjects <span class="op">=</span> <span class="fu">I</span><span class="op">(</span><span class="fl">20021</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">POST</span><span class="op">(</span><span class="va">endpoint</span>, body<span class="op">=</span><span class="va">our_body</span>, encode <span class="op">=</span> <span class="st">"json"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">content</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fromJSON</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">%&gt;%</span> <span class="fu">head</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>        id                                       text   unit
1   FOLK1A Population at the first day of the quarter Number
2  FOLK1AM   Population at the first day of the month Number
3  BEFOLK1                      Population 1. January Number
4  BEFOLK2                      Population 1. January Number
5    FOLK3                      Population 1. January Number
6 FOLK3FOD                      Population 1. January Number
              updated firstPeriod latestPeriod active
1 2024-05-10T08:00:00      2008Q1       2024Q2   TRUE
2 2024-07-10T08:00:00     2021M10      2024M06   TRUE
3 2024-02-12T08:00:00        1971         2024   TRUE
4 2024-02-12T08:00:00        1901         2024   TRUE
5 2024-02-12T08:00:00        2008         2024   TRUE
6 2024-02-12T08:00:00        2008         2024   TRUE
                                          variables
1            region, sex, age, marital status, time
2                            region, sex, age, time
3                    sex, age, marital status, time
4                                    sex, age, time
5    day of birth, birth month, year of birth, time
6 day of birth, birth month, country of birth, time</code></pre>
</div>
<p>There are 21 tables under this subject. Let us see what information
we can get about table “FOLK1A”:</p>
<p>We now need the third endpoint:</p>
<div class="codewrapper sourceCode" id="cb28">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endpoint</span> <span class="op">&lt;-</span> <span class="st">"http://api.statbank.dk/v1/tableinfo"</span></span></code></pre>
</div>
<div class="codewrapper sourceCode" id="cb29">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">our_body</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>lang <span class="op">=</span> <span class="st">"en"</span>, table <span class="op">=</span> <span class="st">"FOLK1A"</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">POST</span><span class="op">(</span><span class="va">endpoint</span>, body<span class="op">=</span><span class="va">our_body</span>, encode <span class="op">=</span> <span class="st">"json"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">content</span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">fromJSON</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>$id
[1] "FOLK1A"

$text
[1] "Population at the first day of the quarter"

$description
[1] "Population at the first day of the quarter by region, sex, age, marital status and time"

$unit
[1] "Number"

$suppressedDataValue
[1] "0"

$updated
[1] "2024-05-10T08:00:00"

$active
[1] TRUE

$contacts
           name    phone       mail
1 Dorthe Larsen 39173307 dla@dst.dk

$documentation
$documentation$id
[1] "4a12721d-a8b0-4bde-82d7-1d1c6f319de3"

$documentation$url
[1] "https://www.dst.dk/documentationofstatistics/4a12721d-a8b0-4bde-82d7-1d1c6f319de3"


$footnote
NULL

$variables
          id           text elimination  time                     map
1     OMRÅDE         region        TRUE FALSE denmark_municipality_07
2        KØN            sex        TRUE FALSE                    &lt;NA&gt;
3      ALDER            age        TRUE FALSE                    &lt;NA&gt;
4 CIVILSTAND marital status        TRUE FALSE                    &lt;NA&gt;
5        Tid           time       FALSE  TRUE                    &lt;NA&gt;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               values
1                                                                                                                                                                                           000, 084, 101, 147, 155, 185, 165, 151, 153, 157, 159, 161, 163, 167, 169, 183, 173, 175, 187, 201, 240, 210, 250, 190, 270, 260, 217, 219, 223, 230, 400, 411, 085, 253, 259, 350, 265, 269, 320, 376, 316, 326, 360, 370, 306, 329, 330, 340, 336, 390, 083, 420, 430, 440, 482, 410, 480, 450, 461, 479, 492, 530, 561, 563, 607, 510, 621, 540, 550, 573, 575, 630, 580, 082, 710, 766, 615, 707, 727, 730, 741, 740, 746, 706, 751, 657, 661, 756, 665, 760, 779, 671, 791, 081, 810, 813, 860, 849, 825, 846, 773, 840, 787, 820, 851, All Denmark, Region Hovedstaden, Copenhagen, Frederiksberg, Dragør, Tårnby, Albertslund, Ballerup, Brøndby, Gentofte, Gladsaxe, Glostrup, Herlev, Hvidovre, Høje-Taastrup, Ishøj, Lyngby-Taarbæk, Rødovre, Vallensbæk, Allerød, Egedal, Fredensborg, Frederikssund, Furesø, Gribskov, Halsnæs, Helsingør, Hillerød, Hørsholm, Rudersdal, Bornholm, Christiansø, Region Sjælland, Greve, Køge, Lejre, Roskilde, Solrød, Faxe, Guldborgsund, Holbæk, Kalundborg, Lolland, Næstved, Odsherred, Ringsted, Slagelse, Sorø, Stevns, Vordingborg, Region Syddanmark, Assens, Faaborg-Midtfyn, Kerteminde, Langeland, Middelfart, Nordfyns, Nyborg, Odense, Svendborg, Ærø, Billund, Esbjerg, Fanø, Fredericia, Haderslev, Kolding, Sønderborg, Tønder, Varde, Vejen, Vejle, Aabenraa, Region Midtjylland, Favrskov, Hedensted, Horsens, Norddjurs, Odder, Randers, Samsø, Silkeborg, Skanderborg, Syddjurs, Aarhus, Herning, Holstebro, Ikast-Brande, Lemvig, Ringkøbing-Skjern, Skive, Struer, Viborg, Region Nordjylland, Brønderslev, Frederikshavn, Hjørring, Jammerbugt, Læsø, Mariagerfjord, Morsø, Rebild, Thisted, Vesthimmerlands, Aalborg
2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        TOT, 1, 2, Total, Men, Women
3 IALT, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, Age, total, 0 years, 1 year, 2 years, 3 years, 4 years, 5 years, 6 years, 7 years, 8 years, 9 years, 10 years, 11 years, 12 years, 13 years, 14 years, 15 years, 16 years, 17 years, 18 years, 19 years, 20 years, 21 years, 22 years, 23 years, 24 years, 25 years, 26 years, 27 years, 28 years, 29 years, 30 years, 31 years, 32 years, 33 years, 34 years, 35 years, 36 years, 37 years, 38 years, 39 years, 40 years, 41 years, 42 years, 43 years, 44 years, 45 years, 46 years, 47 years, 48 years, 49 years, 50 years, 51 years, 52 years, 53 years, 54 years, 55 years, 56 years, 57 years, 58 years, 59 years, 60 years, 61 years, 62 years, 63 years, 64 years, 65 years, 66 years, 67 years, 68 years, 69 years, 70 years, 71 years, 72 years, 73 years, 74 years, 75 years, 76 years, 77 years, 78 years, 79 years, 80 years, 81 years, 82 years, 83 years, 84 years, 85 years, 86 years, 87 years, 88 years, 89 years, 90 years, 91 years, 92 years, 93 years, 94 years, 95 years, 96 years, 97 years, 98 years, 99 years, 100 years, 101 years, 102 years, 103 years, 104 years, 105 years, 106 years, 107 years, 108 years, 109 years, 110 years, 111 years, 112 years, 113 years, 114 years, 115 years, 116 years, 117 years, 118 years, 119 years, 120 years, 121 years, 122 years, 123 years, 124 years, 125 years
4                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         TOT, U, G, E, F, Total, Never married, Married/separated, Widowed, Divorced
5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      2008K1, 2008K2, 2008K3, 2008K4, 2009K1, 2009K2, 2009K3, 2009K4, 2010K1, 2010K2, 2010K3, 2010K4, 2011K1, 2011K2, 2011K3, 2011K4, 2012K1, 2012K2, 2012K3, 2012K4, 2013K1, 2013K2, 2013K3, 2013K4, 2014K1, 2014K2, 2014K3, 2014K4, 2015K1, 2015K2, 2015K3, 2015K4, 2016K1, 2016K2, 2016K3, 2016K4, 2017K1, 2017K2, 2017K3, 2017K4, 2018K1, 2018K2, 2018K3, 2018K4, 2019K1, 2019K2, 2019K3, 2019K4, 2020K1, 2020K2, 2020K3, 2020K4, 2021K1, 2021K2, 2021K3, 2021K4, 2022K1, 2022K2, 2022K3, 2022K4, 2023K1, 2023K2, 2023K3, 2023K4, 2024K1, 2024K2, 2008Q1, 2008Q2, 2008Q3, 2008Q4, 2009Q1, 2009Q2, 2009Q3, 2009Q4, 2010Q1, 2010Q2, 2010Q3, 2010Q4, 2011Q1, 2011Q2, 2011Q3, 2011Q4, 2012Q1, 2012Q2, 2012Q3, 2012Q4, 2013Q1, 2013Q2, 2013Q3, 2013Q4, 2014Q1, 2014Q2, 2014Q3, 2014Q4, 2015Q1, 2015Q2, 2015Q3, 2015Q4, 2016Q1, 2016Q2, 2016Q3, 2016Q4, 2017Q1, 2017Q2, 2017Q3, 2017Q4, 2018Q1, 2018Q2, 2018Q3, 2018Q4, 2019Q1, 2019Q2, 2019Q3, 2019Q4, 2020Q1, 2020Q2, 2020Q3, 2020Q4, 2021Q1, 2021Q2, 2021Q3, 2021Q4, 2022Q1, 2022Q2, 2022Q3, 2022Q4, 2023Q1, 2023Q2, 2023Q3, 2023Q4, 2024Q1, 2024Q2</code></pre>
</div>
<p>This is a bit more complicated. We are told that:</p>
<ol style="list-style-type: decimal">
<li><p>there are five columns in this table.</p></li>
<li><p>They each have an id</p></li>
<li><p>And a descriptive text</p></li>
<li><p>Elimination means that the API will attempt to eliminate the
variables we have not chosen values for when data is returned. This
makes sense when we get to point 7.</p></li>
<li><p>time - only one of the variables contain information about a
point in time.</p></li>
<li><p>One of the variables can be mapped to - well a map</p></li>
<li><p>The final column provides information about which values are
stored in the variable. There are 105 different regions in Denmark. And
if we do not choose a specific region - the API will attempt to
eliminate this facetting, and return data for all of Denmark.</p></li>
</ol>
<p>These data provides useful information for constructing the final
call to the API in order to get the data.</p>
<p>We will now need the final endpoint:</p>
<div class="codewrapper sourceCode" id="cb31">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">endpoint</span> <span class="op">&lt;-</span> <span class="st">"http://api.statbank.dk/v1/data"</span></span></code></pre>
</div>
<p>And we will need to specify which information, from which table, we
want data in the body of the request. That is a bit more complicated. We
need to make a list of lists!</p>
<div class="codewrapper sourceCode" id="cb32">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">variables</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span><span class="fu">list</span><span class="op">(</span>code <span class="op">=</span> <span class="st">"OMRÅDE"</span>, values <span class="op">=</span> <span class="fu">I</span><span class="op">(</span><span class="st">"*"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  <span class="fu">list</span><span class="op">(</span>code <span class="op">=</span> <span class="st">"CIVILSTAND"</span>, values <span class="op">=</span> <span class="fu">I</span><span class="op">(</span><span class="fu">c</span><span class="op">(</span><span class="st">"U"</span>, <span class="st">"G"</span>, <span class="st">"E"</span>, <span class="st">"F"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  <span class="fu">list</span><span class="op">(</span>code <span class="op">=</span> <span class="st">"Tid"</span>, values <span class="op">=</span> <span class="fu">I</span><span class="op">(</span><span class="st">"*"</span><span class="op">)</span><span class="op">)</span></span>
<span>              <span class="op">)</span></span>
<span></span>
<span><span class="va">our_body</span> <span class="op">&lt;-</span> <span class="fu">list</span><span class="op">(</span>table <span class="op">=</span> <span class="st">"FOLK1A"</span>, lang <span class="op">=</span> <span class="st">"en"</span>, format <span class="op">=</span> <span class="st">"CSV"</span>, variables <span class="op">=</span> <span class="va">variables</span><span class="op">)</span></span></code></pre>
</div>
<p>The final call boils down to:</p>
<div class="codewrapper sourceCode" id="cb33">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">POST</span><span class="op">(</span><span class="va">endpoint</span>, body<span class="op">=</span><span class="va">our_body</span>, encode <span class="op">=</span> <span class="st">"json"</span><span class="op">)</span></span></code></pre>
</div>
<p>The data is returned as csv - we defined that in “our_body”, so we
now need to extract it a bit differently:</p>
<div class="codewrapper sourceCode" id="cb34">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="va">data</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">content</span><span class="op">(</span>type <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span> <span class="op">%&gt;%</span> </span>
<span>  <span class="fu">read_csv2</span><span class="op">(</span><span class="op">)</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>ℹ Using "','" as decimal and "'.'" as grouping mark. Use `read_delim()` for more control.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>No encoding supplied: defaulting to UTF-8.</code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code>Rows: 27720 Columns: 4
── Column specification ────────────────────────────────────────────────────────
Delimiter: ";"
chr (3): OMRÅDE, CIVILSTAND, TID
dbl (1): INDHOLD

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="codewrapper sourceCode" id="cb38">
<h3 class="code-label">R<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span></span></code></pre>
</div>
<div class="codewrapper">
<h3 class="code-label">OUTPUT<i aria-hidden="true" data-feather="chevron-left"></i><i aria-hidden="true" data-feather="chevron-right"></i>
</h3>
<pre class="output" tabindex="0"><code># A tibble: 27,720 × 4
   OMRÅDE      CIVILSTAND    TID    INDHOLD
   &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;    &lt;dbl&gt;
 1 All Denmark Never married 2008Q1 2552700
 2 All Denmark Never married 2008Q2 2563134
 3 All Denmark Never married 2008Q3 2564705
 4 All Denmark Never married 2008Q4 2568255
 5 All Denmark Never married 2009Q1 2575185
 6 All Denmark Never married 2009Q2 2584993
 7 All Denmark Never married 2009Q3 2584560
 8 All Denmark Never married 2009Q4 2588198
 9 All Denmark Never married 2010Q1 2593172
10 All Denmark Never married 2010Q2 2604129
# ℹ 27,710 more rows</code></pre>
</div>
<p>Voila! We have a dataframe with information about how many persons in
Denmark were married (or not) at different points in time.</p>
<p>That was a bit complicated. There are easier ways to do it.</p>
<p>We will look at that shortly. So why do it this way? These techniques
are the same techniques we use when we access an arbitrary other API.
The fields, endpoints etc might be different. We might have an added
complication of having to login to it. But the techniques can be
reused.</p>
<div id="keypoints1" class="callout keypoints">
<div class="callout-square">
<i class="callout-icon" data-feather="key"></i>
</div>
<div class="callout-inner">
<h3 class="callout-title">Key Points<a class="anchor" aria-label="anchor" href="#keypoints1"></a>
</h3>
<div class="callout-content">
<ul>
<li>“POST requests to servers put specific demands on how we request
data”</li>
<li>“Using an API requires us to understand (some of) the ways the API
works”</li>
<li>“Different searches typically requires different endpoints”</li>
</ul>
</div>
</div>
</div>
<!--
Place links that you need to refer to multiple times across pages here. Delete
any links that you are not going to use.
 -->
</section></section>
</div>
    </main>
</div>
<!-- END  : inst/pkgdown/templates/content-extra.html -->

      </div>
<!--/div.row-->
      		<footer class="row footer mx-md-3"><hr>
<div class="col-md-6">
        <p>This lesson is subject to the <a href="CODE_OF_CONDUCT.html">Code of Conduct</a></p>
        <p>

        <a href="https://github.com/chrbknudsen/R-api_new/edit/main/README.md" class="external-link">Edit on GitHub</a>

	
        | <a href="https://github.com/chrbknudsen/R-api_new/blob/main/CONTRIBUTING.md" class="external-link">Contributing</a>
        | <a href="https://github.com/chrbknudsen/R-api_new/" class="external-link">Source</a></p>
				<p><a href="https://github.com/chrbknudsen/R-api_new/blob/main/CITATION.cff" class="external-link">Cite</a> | <a href="mailto:team@carpentries.org">Contact</a> | <a href="https://carpentries.org/about/" class="external-link">About</a></p>
			</div>
			<div class="col-md-6">

        <p>Materials licensed under <a href="LICENSE.html">CC-BY 4.0</a> by the authors</p>

        <p>Template licensed under <a href="https://creativecommons.org/licenses/by-sa/4.0/" class="external-link">CC-BY 4.0</a> by <a href="https://carpentries.org/" class="external-link">The Carpentries</a></p>
        <p>Built with <a href="https://github.com/carpentries/sandpaper/tree/0.16.5" class="external-link">sandpaper (0.16.5)</a>, <a href="https://github.com/carpentries/pegboard/tree/0.7.6" class="external-link">pegboard (0.7.6)</a>, and <a href="https://github.com/carpentries/varnish/tree/1.0.3" class="external-link">varnish (1.0.3)</a></p>
			</div>
		</footer>
</div> <!-- / div.container -->
	<div id="to-top">
		<a href="#top">
      <i class="search-icon" data-feather="arrow-up" role="img" aria-label="Back To Top"></i><br><!-- <span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top --><span class="d-none d-sm-none d-md-none d-lg-none d-xl-block">Back</span> To Top
		</a>
	</div>
  <script type="application/ld+json">
    {
  "@context": "https://schema.org",
  "@type": "TrainingMaterial",
  "@id": "https://chrbknudsen.github.io/R-api_new/aio.html",
  "inLanguage": "en",
  "dct:conformsTo": "https://bioschemas.org/profiles/TrainingMaterial/1.0-RELEASE",
  "description": "A Carpentries Lesson teaching foundational data and coding skills to researchers worldwide",
  "keywords": "software, data, lesson, The Carpentries",
  "name": "All in One View",
  "creativeWorkStatus": "active",
  "url": "https://chrbknudsen.github.io/R-api_new/aio.html",
  "identifier": "https://chrbknudsen.github.io/R-api_new/aio.html",
  "dateCreated": "2024-07-29",
  "dateModified": "2024-08-01",
  "datePublished": "2024-08-01"
}

  </script><script>
		feather.replace();
	</script>
</body>
</html><!-- END:   inst/pkgdown/templates/layout.html-->

